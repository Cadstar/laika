<% @page_header = 'Patient Library' %>
<div class="column span-20 last">
  <table id="dashboard">
  
    <tr>
  	<% if Laika.use_xds && LOCAL_NIST_XDS %>
  		<th><div>XDS</div></th>
  	<% end %>
      <th class="<%= sort_order_class('name') %>"><%= link_to_sort 'name', 'Template' %></th>
      <th class="<%= sort_order_class('created_at') %>"><%= link_to_sort 'created_at', 'Created on' %></th>
      <th class="<%= sort_order_class('updated_at') %>"><%= link_to_sort 'updated_at', 'Last modified' %></th>
      <th colspan="2">Actions</th>
    </tr>
  
    <% @patients.each do |patient| -%>
      <%= render patient %>
    <% end -%>
  </table>
  
  <div class="column span-9 append-1 box">
    <h3>Create a new patient</h3>
    <% form_for(Patient.new) do |f| %>
      <%= f.label :name, "Enter the patient's full name" %>
      <br />
      <%= f.text_field :name %>
      <%= f.submit "Create Patient" %>
    <% end %>
  </div>
  
  <div class="column span-9 box last">
    <h3>Autogenerate a patient</h3>
    <br />
    <%= button_to("Add an autogenerated patient to the library", autoCreate_patients_path) %>
  </div>
  
  <div class="column span-9 box">
    <h3>Import patient utility</h3>
    <p class="notice">Experimental: Import a C32 document to create a Laika patient record. Note that this is an import utility; assign a Generate and Format test to validate and inspect your C32 document.</p>
  	<% form_for(:clinical_document, 
  	            :url => {
  	              :controller => 'patients',
  	              :action => 'import' },
  	            :html => {
  	              :multipart => true,
  	              :onsubmit => %[
  	                if ($("new_record").value.blank())
  	                  { alert("You must specify a file to upload."); return false }
  	                else return true
  	              ] }) do |f| -%>
  	  <label>Select a C32 record to import</label><br/>
  	  <%= f.file_field  :uploaded_data, :id => "new_record"%><br/><br/>
  	  <%= submit_tag 'Import' %>
  	<% end -%>
  </div>
</div> 
